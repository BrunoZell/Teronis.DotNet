<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <GenerateFilesystemPackageMSBuildProperties Condition="!$(GenerateFilesystemPackageMSBuildProperties.Contains('Configuration='))">
      Configuration=$(Configuration);$(GenerateFilesystemPackageMSBuildProperties)
    </GenerateFilesystemPackageMSBuildProperties>
  </PropertyGroup>

  <Target Name="RestoreBuildPackReferencesBeforeBuild" DependsOnTargets="$(GenerateFilesystemPackageRestoreBuildPackProjectsBeforeBuildDependsOn)" BeforeTargets="BeforeBuild" Condition="'@(GenerateFilesystemPackageProjects)' != ''">
    <MSBuild Projects="%(GenerateFilesystemPackageProjects.Identity)" Targets="Restore;Build;GenerateFilesystemPackage" Properties="$(GenerateFilesystemPackageMSBuildProperties)" />
  </Target>

  <Target Name="CleanReferencesBeforeBuild" DependsOnTargets="$(GenerateFilesystemPackageCleanProjectsBeforeBuildDependsOn)" BeforeTargets="BeforeClean" Condition="'@(GenerateFilesystemPackageProjects)' != ''">
    <MSBuild Projects="%(GenerateFilesystemPackageProjects.Identity)" Targets="Clean" Properties="$(GenerateFilesystemPackageMSBuildProperties)" />
  </Target>

</Project>